"use strict";riot.tag2("comment","<div class=\"ui row\"> <div class=\"ui grid comment-heading\"> <div class=\"two wide column\"> <a class=\"ui tiny circular image\" href=\"/profiles/{opts.cmt.author.id}/\"> <img riot-src=\"{opts.cmt.author.portrait}\"> </a> </div> <div class=\"eight wide column\"> <div class=\"ui header header-text-container\"> <div class=\"content header-text\"> <a href=\"/profiles/{opts.cmt.author.id}/\"> {opts.cmt.author.reference} </a> <div class=\"sub header comment-date\"> {format_datestring(opts.cmt.date_created)} </div> </div> </div> </div> <div class=\"six wide column\"> <div if=\"{opts.cmt.author.id == TT.user.pk || TT.user.is_superuser}\" class=\"ui right floated mini icon button delete-button\" id=\"delete-comment-{opts.cmt.id}\"> <i class=\"black delete icon\"></i> </div> </div> </div> </div> <div class=\"ui divider\"></div> <div class=\"row content\"> <div class=\"ui content comment-text\"> {opts.cmt.text} </div> </div> <comment class=\"ui grid reply\" each=\"{reply in opts.cmt.replies}\" cmt=\"{reply}\"></comment> <form if=\"{!opts.cmt.parent}\" class=\"ui form replyform\"> <div class=\"field\"> <textarea id=\"reply-text-area-{opts.cmt.id}\" rows=\"2\" type=\"text\" name=\"reply\" placeholder=\"Write a reply...\"></textarea> </div> </form>","comment { min-height: 60px; width: 80%; margin: 30px !important; padding: 20px 45px 20px 45px !important; background: white; border-radius: 5px; } comment .reply,[data-is=\"comment\"] .reply{ margin: 15px !important; background: #eeeeee; border-radius: 4px !important; padding-top: 0 !important; padding-bottom: 0 !important; width: 90%; } comment .comment-heading,[data-is=\"comment\"] .comment-heading{ width: 100% !important; min-height: 80px; } comment .reply .comment-heading,[data-is=\"comment\"] .reply .comment-heading{ min-height: 65px; } comment .header-text,[data-is=\"comment\"] .header-text{ height: 70px; } comment .reply .header-text,[data-is=\"comment\"] .reply .header-text{ height: 50px; } comment .header-text,[data-is=\"comment\"] .header-text{ display: flex !important; flex-direction: column; justify-content: space-between; text-align: start; } comment .comment-date,[data-is=\"comment\"] .comment-date{ font-size: 1.0em !important; color: #aaaaaa; } comment .comment-text,[data-is=\"comment\"] .comment-text{ text-align: start; font-size: 1.3em; line-height: 1.5em; white-space: pre-line; } comment .row.content,[data-is=\"comment\"] .row.content{ display: flex; justify-content: start !important; } comment .replyform,[data-is=\"comment\"] .replyform{ width: 100%; margin: 15px; } comment .delete-button,[data-is=\"comment\"] .delete-button{ width: 30px; height: 30px; background: #bbbbbb !important; } comment .black.delete.icon,[data-is=\"comment\"] .black.delete.icon{ margin: auto !important; } comment .delete-options,[data-is=\"comment\"] .delete-options{ display: flex !important; justify-content: center; }","",function(a){function b(a,b){a.keydown(function(a){if(b)$(this).val(function(){return""});else if((10==a.keyCode||13==a.keyCode)&&a.ctrlKey)$(this).val(function(b,c){var d=a.target.selectionStart,e=c.slice(0,d)+"\n"+c.slice(d);return e});else if(13===a.keyCode&&!a.ctrlKey){a.preventDefault();var d=$(this).val();c.post_comment(d,c.opts.cmt.article,c.opts.cmt.id)}})}var c=this;c.on("mount",function(){var d="#reply-text-area-"+c.opts.cmt.id,e=$(d);"None"==TT.user.pk?(b(e,!0),e.on("click",function(){$("#login_menu").click()})):b(e,!1);var f=$("#delete-comment-"+c.opts.cmt.id);f.on("click",function(){var b=a.cmt.id;TT.events.trigger("comment_delete",b)})}),c.post_comment=function(a,b,c){var d={text:a,parent:c,author:TT.user.pk,article:b};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(d),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(a){print("comment post error:",a)})}}),riot.tag2("comment-section","<div class=\"ui container\"> <form class=\"ui form commentform\"> <div class=\"field\"> <textarea rows=\"3\" type=\"text\" name=\"comment\" placeholder=\"Respond with a comment...\" ref=\"comment_textarea\"></textarea> </div> </form> <comment class=\"ui centered grid outer-comment\" each=\"{comm in comments}\" cmt=\"{comm}\"></comment> </div>","comment-section { min-height: 400px; background: var(--TT-blue); } comment-section .outer-comment,[data-is=\"comment-section\"] .outer-comment{ width: 70% !important; margin-left: auto !important; margin-right: auto !important; } comment-section .commentform,[data-is=\"comment-section\"] .commentform{ width: 70%; margin: 50px auto 50px auto; }","",function(){function a(a){$.ajax({type:"GET",url:"/api/v1/article_comments/"+d.opts.article_id+"/",data:null,contentType:"application/json",dataType:"json"}).done(function(b){d.comments=b,d.update(),a&&$("html,body").animate({scrollTop:document.body.scrollHeight},350)})}function b(a){$.ajax({type:"DELETE",url:"/api/v1/comments/"+a,data:JSON.stringify(null),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(a){print("comment post error:",a)})}function c(a,b){a.keydown(function(a){if(b)$(this).val(function(){return""});else if((10==a.keyCode||13==a.keyCode)&&a.ctrlKey)$(this).val(function(b,c){var d=a.target.selectionStart,e=c.slice(0,d)+"\n"+c.slice(d);return e});else if(13===a.keyCode&&!a.ctrlKey){a.preventDefault();var c=$(this).val();d.post_comment(c),$(this).val(function(){return""}),$(this).blur()}})}var d=this;d.post_comment=function(a){var b={text:a,author:TT.user.pk,article:d.opts.article_id,parent:null};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(b),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!0)}).fail(function(a){print("comment post error:",a)})},d.on("mount",function(){var b=$(d.refs.comment_textarea);"None"==TT.user.pk?(c(b,!0),b.on("click",function(){$("#login_menu").click()})):c(b,!1),a(!1)}),TT.events.on("comment_posted",function(b){a(b)}),TT.events.on("comment_delete",function(a){$(".ui.basic.modal").modal({onApprove:function onApprove(){b(a)}}).modal("show")})}),riot.tag2("perlin","<canvas if=\"{!!opts.border_radius}\" id=\"perlin-3d-canvas\" riot-style=\"border-radius: {opts.border_radius}px;\"></canvas> <canvas if=\"{!opts.border_radius}\" id=\"perlin-3d-canvas\"></canvas>","perlin canvas,[data-is=\"perlin\"] canvas{ width: 100%; height: 100%; display: block; }","",function(){var a=this;a.on("mount",function(){function b(a,b){for(var c=2,d=a.vertices.length,e=0;e<d;e++)a.vertices[e].z=.13*v.get_value(a.vertices[e].x*c,a.vertices[e].y*c,b);a.verticesNeedUpdate=!0}function c(a){a*=15e-5;var d=k.domElement,e=d.clientWidth,f=d.clientHeight;if(d.width!=e||d.height!=f){k.setSize(e,f,!1);var g=2*(e/f)/2;m.left=-g,m.right=g,m.updateProjectionMatrix()}b(u.geometry,a),k.render(l,m),requestAnimationFrame(c)}var d=Math.PI,e=16777215,f=2,g=2,i=5592405;!a.opts.mesh_color||(i=a.opts.mesh_color);var j=document.querySelector("#perlin-3d-canvas"),k=new THREE.WebGLRenderer({canvas:j}),l=new THREE.Scene,m=new THREE.OrthographicCamera(f/-2,f/2,g/2,g/-2,-1e3,1e3),n=new THREE.AmbientLight(e),o=[];o[0]=new THREE.PointLight(16777215,1,0),o[1]=new THREE.PointLight(16777215,1,0),o[2]=new THREE.PointLight(16777215,1,0),o[0].position.set(0,200,0),o[1].position.set(100,200,100),o[2].position.set(-100,-200,-100),l.background=a.opts.background_color?new THREE.Color(a.opts.background_color):new THREE.Color(e);var p=2,q=window.devicePixelRatio;q<p?q=p:q>4&&(q=4),k.setPixelRatio(q),print("pixel ratio:",q);var r=4,h=12,s=new THREE.PlaneGeometry(4,r,4*h,r*h),t=new THREE.MeshStandardMaterial({color:i,wireframe:!0}),u=new THREE.Mesh(s,t),v=new Perlin(3,1,1);b(u.geometry,0),u.rotation.x=-d/3,u.rotation.z=.12*-d,u.position.x=1.3,print(u),l.add(u),l.add(n),l.add(o[0]),l.add(o[1]),l.add(o[2]),k.render(l,m),requestAnimationFrame(c)})});