"use strict";riot.tag2("comment","<div class=\"ui row\"> <div class=\"ui grid comment-heading\"> <div class=\"two wide column\"> <a class=\"ui tiny circular image\" href=\"/profiles/{opts.cmt.author.id}/\"> <img riot-src=\"{opts.cmt.author.portrait}\"> </a> </div> <div class=\"eight wide column\"> <div class=\"ui header header-text-container\"> <div class=\"content header-text\"> <a href=\"/profiles/{opts.cmt.author.id}/\"> {opts.cmt.author.reference} </a> <div class=\"sub header comment-date\"> {format_datestring(opts.cmt.date_created)} </div> </div> </div> </div> <div class=\"six wide column\"> <div if=\"{opts.cmt.author.id == TT.user.pk || TT.user.is_superuser}\" class=\"ui right floated mini icon button delete-button\" id=\"delete-comment-{opts.cmt.id}\"> <i class=\"black delete icon\"></i> </div> </div> </div> </div> <div class=\"ui divider\"></div> <div class=\"row content\"> <div class=\"ui content comment-text\"> {opts.cmt.text} </div> </div> <comment class=\"ui grid reply\" each=\"{reply in opts.cmt.replies}\" cmt=\"{reply}\"></comment> <form if=\"{!opts.cmt.parent}\" class=\"ui form replyform\"> <div class=\"field\"> <textarea id=\"reply-text-area-{opts.cmt.id}\" rows=\"2\" type=\"text\" name=\"reply\" placeholder=\"Write a reply...\"></textarea> </div> </form>","comment { min-height: 60px; width: 80%; margin: 30px !important; padding: 20px 45px 20px 45px !important; background: white; border-radius: 5px; } comment .reply,[data-is=\"comment\"] .reply{ margin: 15px !important; background: #eeeeee; border-radius: 4px !important; padding-top: 0 !important; padding-bottom: 0 !important; width: 90%; } comment .comment-heading,[data-is=\"comment\"] .comment-heading{ width: 100% !important; min-height: 80px; } comment .reply .comment-heading,[data-is=\"comment\"] .reply .comment-heading{ min-height: 65px; } comment .header-text,[data-is=\"comment\"] .header-text{ height: 70px; } comment .reply .header-text,[data-is=\"comment\"] .reply .header-text{ height: 50px; } comment .header-text,[data-is=\"comment\"] .header-text{ display: flex !important; flex-direction: column; justify-content: space-between; text-align: start; } comment .comment-date,[data-is=\"comment\"] .comment-date{ font-size: 1.0em !important; color: #aaaaaa; } comment .comment-text,[data-is=\"comment\"] .comment-text{ text-align: start; font-size: 1.3em; line-height: 1.5em; white-space: pre-line; } comment .row.content,[data-is=\"comment\"] .row.content{ display: flex; justify-content: start !important; } comment .replyform,[data-is=\"comment\"] .replyform{ width: 100%; margin: 15px; } comment .delete-button,[data-is=\"comment\"] .delete-button{ width: 30px; height: 30px; background: #bbbbbb !important; } comment .black.delete.icon,[data-is=\"comment\"] .black.delete.icon{ margin: auto !important; } comment .delete-options,[data-is=\"comment\"] .delete-options{ display: flex !important; justify-content: center; }","",function(a){function b(a,b){a.keydown(function(a){if(b)$(this).val(function(){return""});else if((10==a.keyCode||13==a.keyCode)&&a.ctrlKey)$(this).val(function(b,c){var d=a.target.selectionStart,e=c.slice(0,d)+"\n"+c.slice(d);return e});else if(13===a.keyCode&&!a.ctrlKey){a.preventDefault();var d=$(this).val();c.post_comment(d,c.opts.cmt.article,c.opts.cmt.id)}})}var c=this;c.on("mount",function(){var d="#reply-text-area-"+c.opts.cmt.id,e=$(d);"None"==TT.user.pk?(b(e,!0),e.on("click",function(){$("#login_menu").click()})):b(e,!1);var f=$("#delete-comment-"+c.opts.cmt.id);f.on("click",function(){var b=a.cmt.id;TT.events.trigger("comment_delete",b)})}),c.post_comment=function(a,b,c){var d={text:a,parent:c,author:TT.user.pk,article:b};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(d),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(a){print("comment post error:",a)})}}),riot.tag2("comment-section","<div class=\"ui container\"> <form class=\"ui form commentform\"> <div class=\"field\"> <textarea rows=\"3\" type=\"text\" name=\"comment\" placeholder=\"Respond with a comment...\" ref=\"comment_textarea\"></textarea> </div> </form> <comment class=\"ui centered grid outer-comment\" each=\"{comm in comments}\" cmt=\"{comm}\"></comment> </div>","comment-section { min-height: 400px; background: var(--TT-blue); } comment-section .outer-comment,[data-is=\"comment-section\"] .outer-comment{ width: 70% !important; margin-left: auto !important; margin-right: auto !important; } comment-section .commentform,[data-is=\"comment-section\"] .commentform{ width: 70%; margin: 50px auto 50px auto; }","",function(){function a(a){$.ajax({type:"GET",url:"/api/v1/article_comments/"+d.opts.article_id+"/",data:null,contentType:"application/json",dataType:"json"}).done(function(b){d.comments=b,d.update(),a&&$("html,body").animate({scrollTop:document.body.scrollHeight},350)})}function b(a){$.ajax({type:"DELETE",url:"/api/v1/comments/"+a,data:JSON.stringify(null),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(a){print("comment post error:",a)})}function c(a,b){a.keydown(function(a){if(b)$(this).val(function(){return""});else if((10==a.keyCode||13==a.keyCode)&&a.ctrlKey)$(this).val(function(b,c){var d=a.target.selectionStart,e=c.slice(0,d)+"\n"+c.slice(d);return e});else if(13===a.keyCode&&!a.ctrlKey){a.preventDefault();var c=$(this).val();d.post_comment(c),$(this).val(function(){return""}),$(this).blur()}})}var d=this;d.post_comment=function(a){var b={text:a,author:TT.user.pk,article:d.opts.article_id,parent:null};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(b),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!0)}).fail(function(a){print("comment post error:",a)})},d.on("mount",function(){var b=$(d.refs.comment_textarea);"None"==TT.user.pk?(c(b,!0),b.on("click",function(){$("#login_menu").click()})):c(b,!1),a(!1)}),TT.events.on("comment_posted",function(b){a(b)}),TT.events.on("comment_delete",function(a){$(".ui.basic.modal").modal({onApprove:function onApprove(){b(a)}}).modal("show")})}),riot.tag2("perlin","<canvas id=\"tutorial\"></canvas>","perlin canvas,[data-is=\"perlin\"] canvas{ width: 100%; height: 100%; display: block; }","",function(){this.on("mount",function(){function a(a,b){for(var c=2,d=a.vertices.length,e=0;e<d;e++)a.vertices[e].z=.13*t.get_value(a.vertices[e].x*c,a.vertices[e].y*c,b);a.verticesNeedUpdate=!0}function b(c){c*=15e-5;var d=i.domElement,e=d.clientWidth,f=d.clientHeight;if(d.width!=e||d.height!=f){i.setSize(e,f,!1);var g=2*(e/f)/2;k.left=-g,k.right=g,k.updateProjectionMatrix()}a(s.geometry,c),i.render(j,k),requestAnimationFrame(b)}var c=Math.PI,d=16777215,e=2,f=2,g=document.querySelector("#tutorial"),i=new THREE.WebGLRenderer({canvas:g}),j=new THREE.Scene,k=new THREE.OrthographicCamera(e/-2,e/2,f/2,f/-2,-1e3,1e3),l=new THREE.AmbientLight(d),m=[];m[0]=new THREE.PointLight(16777215,1,0),m[1]=new THREE.PointLight(16777215,1,0),m[2]=new THREE.PointLight(16777215,1,0),m[0].position.set(0,200,0),m[1].position.set(100,200,100),m[2].position.set(-100,-200,-100),j.background=new THREE.Color(d);var n=2,o=window.devicePixelRatio;o<n?o=n:o>4&&(o=4),i.setPixelRatio(o),print("pixel ratio:",o);var p=4,h=12,q=new THREE.PlaneGeometry(4,p,4*h,p*h),r=new THREE.MeshStandardMaterial({color:5592405,wireframe:!0}),s=new THREE.Mesh(q,r),t=new Perlin(3,1,1);a(s.geometry,0),s.rotation.x=-c/3,s.rotation.z=.12*-c,s.position.x=1.3,print(s),j.add(s),j.add(l),j.add(m[0]),j.add(m[1]),j.add(m[2]),i.render(j,k),requestAnimationFrame(b)})});