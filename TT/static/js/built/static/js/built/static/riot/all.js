"use strict";riot.tag2("comment","<div class=\"ui row\"> <div class=\"ui grid comment-heading\"> <div class=\"two wide column\"> <a class=\"ui tiny circular image\" href=\"/profiles/{opts.cmt.author.id}/\"> <img riot-src=\"{opts.cmt.author.portrait}\"> </a> </div> <div class=\"eight wide column\"> <div class=\"ui header header-text-container\"> <div class=\"content header-text\"> <a href=\"/profiles/{opts.cmt.author.id}/\"> {opts.cmt.author.reference} </a> <div class=\"sub header comment-date\"> {format_datestring(opts.cmt.date_created)} </div> </div> </div> </div> <div class=\"six wide column\"> <div if=\"{opts.cmt.author.id == TT.user.pk || TT.user.is_superuser}\" class=\"ui right floated mini icon button delete-button\" id=\"delete-comment-{opts.cmt.id}\"> <i class=\"black delete icon\"></i> </div> </div> </div> </div> <div class=\"ui divider\"></div> <div class=\"row content\"> <div class=\"ui content comment-text\"> {opts.cmt.text} </div> </div> <comment class=\"ui grid reply\" each=\"{reply in opts.cmt.replies}\" cmt=\"{reply}\"></comment> <form if=\"{!opts.cmt.parent}\" class=\"ui form replyform\"> <div class=\"field\"> <textarea id=\"reply-text-area-{opts.cmt.id}\" rows=\"2\" type=\"text\" name=\"reply\" placeholder=\"Write a reply...\"></textarea> </div> </form>","comment { min-height: 60px; width: 80%; margin: 30px !important; padding: 20px 45px 20px 45px !important; background: white; border-radius: 5px; } comment .reply,[data-is=\"comment\"] .reply{ margin: 15px !important; background: #eeeeee; border-radius: 4px !important; padding-top: 0 !important; padding-bottom: 0 !important; width: 90%; } comment .comment-heading,[data-is=\"comment\"] .comment-heading{ width: 100% !important; min-height: 80px; } comment .reply .comment-heading,[data-is=\"comment\"] .reply .comment-heading{ min-height: 65px; } comment .header-text,[data-is=\"comment\"] .header-text{ height: 70px; } comment .reply .header-text,[data-is=\"comment\"] .reply .header-text{ height: 50px; } comment .header-text,[data-is=\"comment\"] .header-text{ display: flex !important; flex-direction: column; justify-content: space-between; text-align: start; } comment .comment-date,[data-is=\"comment\"] .comment-date{ font-size: 1.0em !important; color: #aaaaaa; } comment .comment-text,[data-is=\"comment\"] .comment-text{ text-align: start; font-size: 1.3em; line-height: 1.5em; white-space: pre-line; } comment .row.content,[data-is=\"comment\"] .row.content{ display: flex; justify-content: start !important; } comment .replyform,[data-is=\"comment\"] .replyform{ width: 100%; margin: 15px; } comment .delete-button,[data-is=\"comment\"] .delete-button{ width: 30px; height: 30px; background: #bbbbbb !important; } comment .black.delete.icon,[data-is=\"comment\"] .black.delete.icon{ margin: auto !important; } comment .delete-options,[data-is=\"comment\"] .delete-options{ display: flex !important; justify-content: center; }","",function(d){function a(c,e){c.keydown(function(f){if(e)$(this).val(function(){return""});else if((10==f.keyCode||13==f.keyCode)&&f.ctrlKey)$(this).val(function(a,b){var c=f.target.selectionStart,d=b.slice(0,c)+"\n"+b.slice(c);return d});else if(13===f.keyCode&&!f.ctrlKey){f.preventDefault();var a=$(this).val();b.post_comment(a,b.opts.cmt.article,b.opts.cmt.id)}})}var b=this;b.on("mount",function(){var c="#reply-text-area-"+b.opts.cmt.id,g=$(c);"None"==TT.user.pk?(a(g,!0),g.on("click",function(){$("#login_menu").click()})):a(g,!1);var e=$("#delete-comment-"+b.opts.cmt.id);e.on("click",function(){var a=d.cmt.id;TT.events.trigger("comment_delete",a)})}),b.post_comment=function(e,a,b){var c={text:e,parent:b,author:TT.user.pk,article:a};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(c),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(b){print("comment post error:",b)})}}),riot.tag2("comment-section","<div class=\"ui container\"> <form class=\"ui form commentform\"> <div class=\"field\"> <textarea rows=\"3\" type=\"text\" name=\"comment\" placeholder=\"Respond with a comment...\" ref=\"comment_textarea\"></textarea> </div> </form> <comment class=\"ui centered grid outer-comment\" each=\"{comm in comments}\" cmt=\"{comm}\"></comment> </div>","comment-section { min-height: 400px; background: var(--TT-blue); } comment-section .outer-comment,[data-is=\"comment-section\"] .outer-comment{ width: 70% !important; margin-left: auto !important; margin-right: auto !important; } comment-section .commentform,[data-is=\"comment-section\"] .commentform{ width: 70%; margin: 50px auto 50px auto; }","",function(){function e(c){$.ajax({type:"GET",url:"/api/v1/article_comments/"+g.opts.article_id+"/",data:null,contentType:"application/json",dataType:"json"}).done(function(a){g.comments=a,g.update(),c&&$("html,body").animate({scrollTop:document.body.scrollHeight},350)})}function f(b){$.ajax({type:"DELETE",url:"/api/v1/comments/"+b,data:JSON.stringify(null),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(b){print("comment post error:",b)})}function a(c,d){c.keydown(function(f){if(d)$(this).val(function(){return""});else if((10==f.keyCode||13==f.keyCode)&&f.ctrlKey)$(this).val(function(a,b){var c=f.target.selectionStart,d=b.slice(0,c)+"\n"+b.slice(c);return d});else if(13===f.keyCode&&!f.ctrlKey){f.preventDefault();var a=$(this).val();g.post_comment(a),$(this).val(function(){return""}),$(this).blur()}})}var g=this;g.post_comment=function(c){var a={text:c,author:TT.user.pk,article:g.opts.article_id,parent:null};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(a),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!0)}).fail(function(b){print("comment post error:",b)})},g.on("mount",function(){var c=$(g.refs.comment_textarea);"None"==TT.user.pk?(a(c,!0),c.on("click",function(){$("#login_menu").click()})):a(c,!1),e(!1)}),TT.events.on("comment_posted",function(a){e(a)}),TT.events.on("comment_delete",function(b){$(".ui.basic.modal").modal({onApprove:function(){f(b)}}).modal("show")})}),riot.tag2("perlin","<canvas id=\"tutorial\"></canvas>","perlin canvas,[data-is=\"perlin\"] canvas{ width: 100%; height: 100%; display: block; }","",function(){this.on("mount",function(){function h(f,a){for(var b=2,c=f.vertices.length,d=0;d<c;d++)f.vertices[d].z=.13*m.get_value(f.vertices[d].x*b,f.vertices[d].y*b,a);f.verticesNeedUpdate=!0}function a(b){b*=15e-5;var k=n.domElement,d=k.clientWidth,e=k.clientHeight;if(k.width!=d||k.height!=e){n.setSize(d,e,!1);var f=2*(d/e)/2;j.left=-f,j.right=f,j.updateProjectionMatrix()}h(l.geometry,b),n.render(i,j),requestAnimationFrame(a)}var b=Math.PI,c=document.querySelector("#tutorial"),n=new THREE.WebGLRenderer({canvas:c}),i=new THREE.Scene,j=new THREE.OrthographicCamera(-1,1,1,-1,-1e3,1e3),d=new THREE.AmbientLight(16777215),e=[];e[0]=new THREE.PointLight(16777215,1,0),e[1]=new THREE.PointLight(16777215,1,0),e[2]=new THREE.PointLight(16777215,1,0),e[0].position.set(0,200,0),e[1].position.set(100,200,100),e[2].position.set(-100,-200,-100),i.background=new THREE.Color(16777215);var f=window.devicePixelRatio;f<2?f=2:4<f&&(f=4),n.setPixelRatio(f),print("pixel ratio:",f);var g=new THREE.PlaneGeometry(4,4,48,48),k=new THREE.MeshStandardMaterial({color:5592405,wireframe:!0}),l=new THREE.Mesh(g,k),m=new Perlin(3,1,1);h(l.geometry,0),l.rotation.x=-b/3,l.rotation.z=.12*-b,l.position.x=1.3,print(l),i.add(l),i.add(d),i.add(e[0]),i.add(e[1]),i.add(e[2]),n.render(i,j),requestAnimationFrame(a)})});