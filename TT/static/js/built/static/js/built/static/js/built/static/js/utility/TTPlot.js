"use strict";function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function")}function _defineProperty(c,d,a){return d in c?Object.defineProperty(c,d,{value:a,enumerable:!0,configurable:!0,writable:!0}):c[d]=a,c}var TTplot=function e(f,a,b){var o=this;_classCallCheck(this,e),_defineProperty(this,"set_array",function(b,c){o.array=b,o.array_opts=c,o.plot_array()}),_defineProperty(this,"plot_array",function(){o.context.strokeStyle=o.array_opts.color,o.context.lineWidth=o.array_opts.line_width,o.context.beginPath();for(var a,b=0;b<o.array.length;b++)a=o.grid_to_canvas_space(o.array[b].x,o.array[b].y),0==b?o.context.moveTo(a.x,a.y):o.context.lineTo(a.x,a.y);o.context.stroke()}),_defineProperty(this,"set_func",function(b,c){o.func=b,o.func_opts=c,o.plot_func()}),_defineProperty(this,"plot_func",function(){o.context.strokeStyle=o.func_opts.color,o.context.lineWidth=o.func_opts.line_width,o.context.beginPath();var d=o.canvas_to_grid_space(0,0),e=o.grid_to_canvas_space(d.x,o.func(d.x));o.context.moveTo(e.x,e.y);for(var a=0;a<o.width;a+=o.func_opts.res){var f=o.canvas_to_grid_space(a,0),g=o.grid_to_canvas_space(f.x,o.func(f.x));o.context.lineTo(g.x,g.y)}o.context.stroke()}),_defineProperty(this,"canvas_to_grid_space",function(a,b){return b=(b-(o.height-o.axes_config.origin.y))/o.tic_spacing,a=(a-o.axes_config.origin.x)/o.tic_spacing,{x:a,y:b}}),_defineProperty(this,"grid_to_canvas_space",function(a,b){return b=o.height-o.axes_config.origin.y-b*o.tic_spacing,a=o.axes_config.origin.x+a*o.tic_spacing,{x:a,y:b}}),_defineProperty(this,"clear",function(){o.context.clearRect(0,0,o.width,o.height)}),_defineProperty(this,"resize_canvas_to_display_size",function(){var b=o.canvas.clientWidth,c=o.canvas.clientHeight;o.dpr=window.devicePixelRatio||1,o.canvas.width=b*o.dpr,o.canvas.height=c*o.dpr,o.width=b,o.height=c,o.context.scale(o.dpr,o.dpr)}),_defineProperty(this,"draw_background",function(){o.context.fillStyle=o.background_color,o.context.fillRect(0,0,o.width,o.height)}),_defineProperty(this,"axes",function(a){o.axes_config=a,o.draw_2d_axes()}),_defineProperty(this,"set_arrows",function(a){o.arrows=a,o.draw_arrows()}),_defineProperty(this,"draw_2d_axes",function(){var b=o.axes_config.origin.x,e=o.axes_config.origin.y,g=o.axes_config.line_width,h=o.axes_config.color;o.context.fillStyle="white",o.context.font=10*g+"px MathJax_Math",e=o.height-e,o.context.lineWidth=g,o.context.strokeStyle=h,o.context.beginPath(),o.context.moveTo(0,e),o.context.lineTo(o.width,e),o.context.stroke(),o.context.moveTo(b,0),o.context.lineTo(b,o.height),o.context.stroke(),o.context.lineWidth=g/2,o.context.beginPath();for(var c=Math.min(o.height,o.width)/60,d=1,i=b+o.tic_spacing,j=e;i<=o.width;)o.axes_config.grid?(o.context.moveTo(i+.5,0),o.context.lineTo(i+.5,o.height)):(o.context.moveTo(i+.5,j-c),o.context.lineTo(i+.5,j+c)),o.context.stroke(),o.x_labels&&o.context.fillText(d,i+.5,j+2*c),i+=o.tic_spacing,d+=1;for(d=-1,i=b-o.tic_spacing;0<=i;)o.axes_config.grid?(o.context.moveTo(i+.5,0),o.context.lineTo(i+.5,o.height)):(o.context.moveTo(i+.5,j-c),o.context.lineTo(i+.5,j+c)),o.context.stroke(),o.x_labels&&o.context.fillText(d,i+.5,j+2*c),i-=o.tic_spacing,d-=1;var k=-1;for(i=b,j=e+o.tic_spacing;j<=o.height;)o.axes_config.grid?(o.context.moveTo(0,j+.5),o.context.lineTo(o.width,j+.5)):(o.context.moveTo(i-c,j+.5),o.context.lineTo(i+c,j+.5)),o.context.stroke(),o.y_labels&&o.context.fillText(k,i+c,j+.5),j+=o.tic_spacing,k-=1;for(k=1,j=e-o.tic_spacing;0<=j;)o.axes_config.grid?(o.context.moveTo(0,j+.5),o.context.lineTo(o.width,j+.5)):(o.context.moveTo(i-c,j+.5),o.context.lineTo(i+c,j+.5)),o.context.stroke(),o.y_labels&&o.context.fillText(k,i+c,j+.5),j-=o.tic_spacing,k+=1}),_defineProperty(this,"draw_arrows",function(){for(var a=0;a<o.arrows.length;a++)o.draw_arrow(o.arrows[a].start_point.x,o.arrows[a].start_point.y,o.arrows[a].delta.x,o.arrows[a].delta.y,o.arrows[a].line_width,o.arrows[a].color,o.arrows[a].label)}),_defineProperty(this,"draw_arrow",function(a,b,c,d,w,x,f){var g=Math.PI,h=Math.sin,i=Math.cos;a=o.axes_config.origin.x+a*o.tic_spacing,b=o.axes_config.origin.y-b*o.tic_spacing,c*=o.tic_spacing,d*=o.tic_spacing,b=o.height-b;var j=a+c,k=b-d;o.context.strokeStyle=x,o.context.fillStyle=x,o.context.lineWidth=w;var l=1.8*w,m=Math.atan2(-d,c),B=l*i(m)+j,C=l*h(m)+k;m+=1/3*(2*g);var p=l*i(m)+j,q=l*h(m)+k;m+=1/3*(2*g);var r=l*i(m)+j,s=l*h(m)+k;if(o.context.beginPath(),o.context.moveTo(a,b),o.context.lineTo(.5*(p+r),.5*(q+s)),o.context.stroke(),o.context.moveTo(B,C),o.context.lineTo(p,q),o.context.lineTo(r,s),o.context.closePath(),o.context.fill(),!!f){var t=a+1.2*c,u=b-1.2*d;o.context.fillStyle=f.color,o.context.font=10*w+"px MathJax_Math",o.context.fillText(f.text,t,u)}}),_defineProperty(this,"set_extra_draw_func",function(a){o.extra_draw_func=a}),this.context=f.getContext("2d"),this.canvas=f,this.resize_canvas_to_display_size(),this.background_color=b,this.draw_background();var c=this;this.x_labels=!1,this.y_labels=!1,this.canvas.addEventListener("mousemove",function(d){var e=d.offsetX,a=c.height-d.offsetY;c.axes_config&&(c.y_labels=!!(e>=c.axes_config.origin.x-4*c.axes_config.line_width&&e<=c.axes_config.origin.x+4*c.axes_config.line_width),c.x_labels=!!(a>=c.axes_config.origin.y-4*c.axes_config.line_width&&a<=c.axes_config.origin.y+4*c.axes_config.line_width),c.clear(),c.draw_background(),c.draw_2d_axes(),!c.arrows||c.draw_arrows(),!c.array||c.plot_array(),!c.func||c.plot_func(),!c.extra_draw_func||c.extra_draw_func(c,e,d.offsetY))}),this.tic_spacing=a};