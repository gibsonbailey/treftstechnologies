"use strict";function _classCallCheck(c,a){if(!(c instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperty(d,a,b){return a in d?Object.defineProperty(d,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[a]=b,d}var TTplot=function g(a,b,c){var x=this;_classCallCheck(this,g),_defineProperty(this,"set_array",function(c,a){x.array=c,x.array_opts=a,x.plot_array()}),_defineProperty(this,"plot_array",function(){x.context.strokeStyle=x.array_opts.color,x.context.lineWidth=x.array_opts.line_width,x.context.beginPath();for(var c,d=0;d<x.array.length;d++)c=x.grid_to_canvas_space(x.array[d].x,x.array[d].y),0==d?x.context.moveTo(c.x,c.y):x.context.lineTo(c.x,c.y);x.context.stroke()}),_defineProperty(this,"set_func",function(c,a){x.func=c,x.func_opts=a,x.plot_func()}),_defineProperty(this,"plot_func",function(){x.context.strokeStyle=x.func_opts.color,x.context.lineWidth=x.func_opts.line_width,x.context.beginPath();var e=x.canvas_to_grid_space(0,0),a=x.grid_to_canvas_space(e.x,x.func(e.x));x.context.moveTo(a.x,a.y);for(var b=0;b<x.width;b+=x.func_opts.res){var g=x.canvas_to_grid_space(b,0),c=x.grid_to_canvas_space(g.x,x.func(g.x));x.context.lineTo(c.x,c.y)}x.context.stroke()}),_defineProperty(this,"canvas_to_grid_space",function(c,d){return d=(d-(x.height-x.axes_config.origin.y))/x.tic_spacing,c=(c-x.axes_config.origin.x)/x.tic_spacing,{x:c,y:d}}),_defineProperty(this,"grid_to_canvas_space",function(c,d){return d=x.height-x.axes_config.origin.y-d*x.tic_spacing,c=x.axes_config.origin.x+c*x.tic_spacing,{x:c,y:d}}),_defineProperty(this,"clear",function(){x.context.clearRect(0,0,x.width,x.height)}),_defineProperty(this,"resize_canvas_to_display_size",function(){var c=x.canvas.clientWidth,a=x.canvas.clientHeight;x.dpr=window.devicePixelRatio||1,x.canvas.width=c*x.dpr,x.canvas.height=a*x.dpr,x.width=c,x.height=a,x.context.scale(x.dpr,x.dpr)}),_defineProperty(this,"draw_background",function(){x.context.fillStyle=x.background_color,x.context.fillRect(0,0,x.width,x.height)}),_defineProperty(this,"axes",function(b){x.axes_config=b,x.draw_2d_axes()}),_defineProperty(this,"set_arrows",function(b){x.arrows=b,x.draw_arrows()}),_defineProperty(this,"draw_2d_axes",function(){var e=x.axes_config.origin.x,a=x.axes_config.origin.y,k=x.axes_config.line_width,c=x.axes_config.color;x.context.fillStyle="white",x.context.font=10*k+"px MathJax_Math",a=x.height-a,x.context.lineWidth=k,x.context.strokeStyle=c,x.context.beginPath(),x.context.moveTo(0,a),x.context.lineTo(x.width,a),x.context.stroke(),x.context.moveTo(e,0),x.context.lineTo(e,x.height),x.context.stroke(),x.context.lineWidth=k/2,x.context.beginPath();for(var d=Math.min(x.height,x.width)/60,f=1,l=e+x.tic_spacing,m=a;l<=x.width;)x.axes_config.grid?(x.context.moveTo(l+.5,0),x.context.lineTo(l+.5,x.height)):(x.context.moveTo(l+.5,m-d),x.context.lineTo(l+.5,m+d)),x.context.stroke(),x.x_labels&&x.context.fillText(f,l+.5,m+2*d),l+=x.tic_spacing,f+=1;for(f=-1,l=e-x.tic_spacing;0<=l;)x.axes_config.grid?(x.context.moveTo(l+.5,0),x.context.lineTo(l+.5,x.height)):(x.context.moveTo(l+.5,m-d),x.context.lineTo(l+.5,m+d)),x.context.stroke(),x.x_labels&&x.context.fillText(f,l+.5,m+2*d),l-=x.tic_spacing,f-=1;var n=-1;for(l=e,m=a+x.tic_spacing;m<=x.height;)x.axes_config.grid?(x.context.moveTo(0,m+.5),x.context.lineTo(x.width,m+.5)):(x.context.moveTo(l-d,m+.5),x.context.lineTo(l+d,m+.5)),x.context.stroke(),x.y_labels&&x.context.fillText(n,l+d,m+.5),m+=x.tic_spacing,n-=1;for(n=1,m=a-x.tic_spacing;0<=m;)x.axes_config.grid?(x.context.moveTo(0,m+.5),x.context.lineTo(x.width,m+.5)):(x.context.moveTo(l-d,m+.5),x.context.lineTo(l+d,m+.5)),x.context.stroke(),x.y_labels&&x.context.fillText(n,l+d,m+.5),m-=x.tic_spacing,n+=1}),_defineProperty(this,"draw_arrows",function(){for(var b=0;b<x.arrows.length;b++)x.draw_arrow(x.arrows[b].start_point.x,x.arrows[b].start_point.y,x.arrows[b].delta.x,x.arrows[b].delta.y,x.arrows[b].line_width,x.arrows[b].color,x.arrows[b].label)}),_defineProperty(this,"draw_arrow",function(e,y,z,A,B,f,g){var h=Math.PI,i=Math.sin,j=Math.cos;e=x.axes_config.origin.x+e*x.tic_spacing,y=x.axes_config.origin.y-y*x.tic_spacing,z*=x.tic_spacing,A*=x.tic_spacing,y=x.height-y;var k=e+z,l=y-A;x.context.strokeStyle=f,x.context.fillStyle=f,x.context.lineWidth=B;var m=1.8*B,n=Math.atan2(-A,z),C=m*j(n)+k,p=m*i(n)+l;n+=1/3*(2*h);var q=m*j(n)+k,r=m*i(n)+l;n+=1/3*(2*h);var s=m*j(n)+k,t=m*i(n)+l;if(x.context.beginPath(),x.context.moveTo(e,y),x.context.lineTo(.5*(q+s),.5*(r+t)),x.context.stroke(),x.context.moveTo(C,p),x.context.lineTo(q,r),x.context.lineTo(s,t),x.context.closePath(),x.context.fill(),!!g){var u=e+1.2*z,v=y-1.2*A;x.context.fillStyle=g.color,x.context.font=10*B+"px MathJax_Math",x.context.fillText(g.text,u,v)}}),_defineProperty(this,"set_extra_draw_func",function(b){x.extra_draw_func=b}),this.context=a.getContext("2d"),this.canvas=a,this.resize_canvas_to_display_size(),this.background_color=c,this.draw_background();var d=this;this.x_labels=!1,this.y_labels=!1,this.canvas.addEventListener("mousemove",function(e){var a=e.offsetX,b=d.height-e.offsetY;!d.axes_config||(d.y_labels=!!(a>=d.axes_config.origin.x-4*d.axes_config.line_width&&a<=d.axes_config.origin.x+4*d.axes_config.line_width),d.x_labels=!!(b>=d.axes_config.origin.y-4*d.axes_config.line_width&&b<=d.axes_config.origin.y+4*d.axes_config.line_width),d.clear(),d.draw_background(),d.draw_2d_axes(),!d.arrows||d.draw_arrows(),!d.array||d.plot_array(),!d.func||d.plot_func(),!d.extra_draw_func||d.extra_draw_func(d,a,e.offsetY))}),this.tic_spacing=b};