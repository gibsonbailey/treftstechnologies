"use strict";riot.tag2("comment","<div class=\"ui row\"> <div class=\"ui grid comment-heading\"> <div class=\"two wide column\"> <a class=\"ui tiny circular image\" href=\"/profiles/{opts.cmt.author.id}/\"> <img riot-src=\"{opts.cmt.author.portrait}\"> </a> </div> <div class=\"eight wide column\"> <div class=\"ui header header-text-container\"> <div class=\"content header-text\"> <a href=\"/profiles/{opts.cmt.author.id}/\"> {opts.cmt.author.reference} </a> <div class=\"sub header comment-date\"> {format_datestring(opts.cmt.date_created)} </div> </div> </div> </div> <div class=\"six wide column\"> <div if=\"{opts.cmt.author.id == TT.user.pk || TT.user.is_superuser}\" class=\"ui right floated mini icon button delete-button\" id=\"delete-comment-{opts.cmt.id}\"> <i class=\"black delete icon\"></i> </div> </div> </div> </div> <div class=\"ui divider\"></div> <div class=\"row content\"> <div class=\"ui content comment-text\"> {opts.cmt.text} </div> </div> <comment class=\"ui grid reply\" each=\"{reply in opts.cmt.replies}\" cmt=\"{reply}\"></comment> <form if=\"{!opts.cmt.parent}\" class=\"ui form replyform\"> <div class=\"field\"> <textarea id=\"reply-text-area-{opts.cmt.id}\" rows=\"2\" type=\"text\" name=\"reply\" placeholder=\"Write a reply...\"></textarea> </div> </form>","comment { min-height: 60px; width: 80%; margin: 30px !important; padding: 20px 45px 20px 45px !important; background: white; border-radius: 5px; } comment .reply,[data-is=\"comment\"] .reply{ margin: 15px !important; background: #eeeeee; border-radius: 4px !important; padding-top: 0 !important; padding-bottom: 0 !important; width: 90%; } comment .comment-heading,[data-is=\"comment\"] .comment-heading{ width: 100% !important; min-height: 80px; } comment .reply .comment-heading,[data-is=\"comment\"] .reply .comment-heading{ min-height: 65px; } comment .header-text,[data-is=\"comment\"] .header-text{ height: 70px; } comment .reply .header-text,[data-is=\"comment\"] .reply .header-text{ height: 50px; } comment .header-text,[data-is=\"comment\"] .header-text{ display: flex !important; flex-direction: column; justify-content: space-between; text-align: start; } comment .comment-date,[data-is=\"comment\"] .comment-date{ font-size: 1.0em !important; color: #aaaaaa; } comment .comment-text,[data-is=\"comment\"] .comment-text{ text-align: start; font-size: 1.3em; line-height: 1.5em; white-space: pre-line; } comment .row.content,[data-is=\"comment\"] .row.content{ display: flex; justify-content: start !important; } comment .replyform,[data-is=\"comment\"] .replyform{ width: 100%; margin: 15px; } comment .delete-button,[data-is=\"comment\"] .delete-button{ width: 30px; height: 30px; background: #bbbbbb !important; } comment .black.delete.icon,[data-is=\"comment\"] .black.delete.icon{ margin: auto !important; } comment .delete-options,[data-is=\"comment\"] .delete-options{ display: flex !important; justify-content: center; }","",function(c){function d(a,b){a.keydown(function(e){if(b)$(this).val(function(){return""});else if((10==e.keyCode||13==e.keyCode)&&e.ctrlKey)$(this).val(function(f,a){var b=e.target.selectionStart,c=a.slice(0,b)+"\n"+a.slice(b);return c});else if(13===e.keyCode&&!e.ctrlKey){e.preventDefault();var c=$(this).val();h.post_comment(c,h.opts.cmt.article,h.opts.cmt.id)}})}var h=this;h.on("mount",function(){var a="#reply-text-area-"+h.opts.cmt.id,b=$(a);"None"==TT.user.pk?(d(b,!0),b.on("click",function(){$("#login_menu").click()})):d(b,!1);var f=$("#delete-comment-"+h.opts.cmt.id);f.on("click",function(){var b=c.cmt.id;TT.events.trigger("comment_delete",b)})}),h.post_comment=function(d,e,a){var b={text:d,parent:a,author:TT.user.pk,article:e};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(b),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(a){print("comment post error:",a)})}}),riot.tag2("comment-section","<div class=\"ui container\"> <form class=\"ui form commentform\"> <div class=\"field\"> <textarea rows=\"3\" type=\"text\" name=\"comment\" placeholder=\"Respond with a comment...\" ref=\"comment_textarea\"></textarea> </div> </form> <comment class=\"ui centered grid outer-comment\" each=\"{comm in comments}\" cmt=\"{comm}\"></comment> </div>","comment-section { min-height: 400px; background: var(--TT-blue); } comment-section .outer-comment,[data-is=\"comment-section\"] .outer-comment{ width: 70% !important; margin-left: auto !important; margin-right: auto !important; } comment-section .commentform,[data-is=\"comment-section\"] .commentform{ width: 70%; margin: 50px auto 50px auto; }","",function(){function b(b){$.ajax({type:"GET",url:"/api/v1/article_comments/"+e.opts.article_id+"/",data:null,contentType:"application/json",dataType:"json"}).done(function(c){e.comments=c,e.update(),b&&$("html,body").animate({scrollTop:document.body.scrollHeight},350)})}function c(a){$.ajax({type:"DELETE",url:"/api/v1/comments/"+a,data:JSON.stringify(null),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!1)}).fail(function(a){print("comment post error:",a)})}function d(a,b){a.keydown(function(g){if(b)$(this).val(function(){return""});else if((10==g.keyCode||13==g.keyCode)&&g.ctrlKey)$(this).val(function(e,a){var b=g.target.selectionStart,c=a.slice(0,b)+"\n"+a.slice(b);return c});else if(13===g.keyCode&&!g.ctrlKey){g.preventDefault();var c=$(this).val();e.post_comment(c),$(this).val(function(){return""}),$(this).blur()}})}var e=this;e.post_comment=function(b){var c={text:b,author:TT.user.pk,article:e.opts.article_id,parent:null};$.ajax({type:"POST",url:"/api/v1/comments/",data:JSON.stringify(c),contentType:"application/json",dataType:"json"}).done(function(){TT.events.trigger("comment_posted",!0)}).fail(function(a){print("comment post error:",a)})},e.on("mount",function(){var a=$(e.refs.comment_textarea);"None"==TT.user.pk?(d(a,!0),a.on("click",function(){$("#login_menu").click()})):d(a,!1),b(!1)}),TT.events.on("comment_posted",function(c){b(c)}),TT.events.on("comment_delete",function(a){$(".ui.basic.modal").modal({onApprove:function onApprove(){c(a)}}).modal("show")})}),riot.tag2("perlin","<canvas id=\"tutorial\"></canvas>","perlin canvas,[data-is=\"perlin\"] canvas{ width: 100%; height: 100%; display: block; }","",function(){this.on("mount",function(){function o(e,f){for(var a=2,b=e.vertices.length,c=0;c<b;c++)e.vertices[c].z=.13*k.get_value(e.vertices[c].x*a,e.vertices[c].y*a,f);e.verticesNeedUpdate=!0}function h(a){a*=15e-5;var g=c.domElement,j=g.clientWidth,d=g.clientHeight;if(g.width!=j||g.height!=d){c.setSize(j,d,!1);var e=2*(j/d)/2;i.left=-e,i.right=e,i.updateProjectionMatrix()}o(q.geometry,a),c.render(n,i),requestAnimationFrame(h)}var a=Math.PI,b=document.querySelector("#tutorial"),c=new THREE.WebGLRenderer({canvas:b}),n=new THREE.Scene,i=new THREE.OrthographicCamera(-1,1,1,-1,-1e3,1e3),j=new THREE.AmbientLight(16777215),d=[];d[0]=new THREE.PointLight(16777215,1,0),d[1]=new THREE.PointLight(16777215,1,0),d[2]=new THREE.PointLight(16777215,1,0),d[0].position.set(0,200,0),d[1].position.set(100,200,100),d[2].position.set(-100,-200,-100),n.background=new THREE.Color(16777215);var e=window.devicePixelRatio;2>e?e=2:4<e&&(e=4),c.setPixelRatio(e),print("pixel ratio:",e);var p=new THREE.PlaneGeometry(4,4,48,48),g=new THREE.MeshStandardMaterial({color:5592405,wireframe:!0}),q=new THREE.Mesh(p,g),k=new Perlin(3,1,1);o(q.geometry,0),q.rotation.x=-a/3,q.rotation.z=.12*-a,q.position.x=1.3,print(q),n.add(q),n.add(j),n.add(d[0]),n.add(d[1]),n.add(d[2]),c.render(n,i),requestAnimationFrame(h)})});