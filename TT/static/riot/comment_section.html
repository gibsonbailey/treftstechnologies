<comment-section>
    <div class="ui container">
        <comment class="ui centered grid outer-comment" csrf="{ self.opts.csrf }" each="{ comm in comments }" cmt="{ comm }"></comment>
    </div>
    <script>
        self = this

        self.get_comments = function () {
            $.ajax({
                type: 'GET',
                url: '/api/v1/article_comments/' + opts.article_id + '/',
                data: null,
                contentType: 'application/json',
                dataType: 'json',
            }).done(function (data) {
                print(data)
                self.comments = data
                self.update()
            })
        }

        self.on('mount', function () {

            self.get_comments()

            let get_comments = self.get_comments

            window.addEventListener('update_comments', function (e) {
                //print(e)
                get_comments()
            })
        })


    </script>
    <style>
        comment-section {
            background: #21324d;
        }

        .outer-comment {
            width: 70% !important;
            margin-left: auto !important;
            margin-right: auto !important;
        }
    </style>
</comment-section>